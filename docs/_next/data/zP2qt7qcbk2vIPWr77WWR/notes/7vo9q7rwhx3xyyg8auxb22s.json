{"pageProps":{"note":{"id":"7vo9q7rwhx3xyyg8auxb22s","title":"0919-[Angular] 驗證與共用元件","desc":"","updated":1663607028791,"created":1663605967730,"tags":["PROG.Angular"],"status":"w","custom":{"status":"w"},"fname":"0drops.2022.0919-[Angular] 驗證與共用元件","type":"note","vault":{"fsPath":"vault"},"contentHash":"278d578956196688992398c0130f9be3","links":[{"type":"frontmatterTag","from":{"fname":"0drops.2022.0919-[Angular] 驗證與共用元件","id":"7vo9q7rwhx3xyyg8auxb22s","vaultName":"vault"},"value":"tags.PROG.Angular","alias":"PROG.Angular","xvault":false,"to":{"fname":"tags.PROG.Angular"}}],"anchors":{"共用元件":{"type":"header","text":"共用元件","value":"共用元件","line":19,"column":0,"depth":2},"法-1-蒐集資料用的表單包含打-api-功能":{"type":"header","text":"法 1: 蒐集資料用的表單(包含打 api 功能)","value":"法-1-蒐集資料用的表單包含打-api-功能","line":23,"column":0,"depth":3},"-新增時":{"type":"header","text":"📌 新增時","value":"-新增時","line":25,"column":0,"depth":5},"-編輯時":{"type":"header","text":"📌 編輯時","value":"-編輯時","line":29,"column":0,"depth":5},"法-2-reactiveform-同步雙向綁定":{"type":"header","text":"法 2: ReactiveForm 同步雙向綁定","value":"法-2-reactiveform-同步雙向綁定","line":42,"column":0,"depth":3},"法-2-demo":{"type":"header","text":"法 2 demo","value":"法-2-demo","line":55,"column":0,"depth":4},"參考資料":{"type":"header","text":"參考資料","value":"參考資料","line":61,"column":0,"depth":4},"欄位驗證":{"type":"header","text":"欄位驗證","value":"欄位驗證","line":67,"column":0,"depth":2},"欄位驗證的方式":{"type":"header","text":"欄位驗證的方式","value":"欄位驗證的方式","line":76,"column":0,"depth":3},"錯誤題示-directive-demo":{"type":"header","text":"錯誤題示 directive demo","value":"錯誤題示-directive-demo","line":89,"column":0,"depth":4}},"children":[],"parent":"0YMTMineOCu8QrkzCD9rn","data":{}},"body":"<h1 id=\"0919-angular-驗證與共用元件\">0919-[Angular] 驗證與共用元件<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#0919-angular-驗證與共用元件\"></a></h1>\n<!-- title: tag0418-2021-表單驗證心得記錄\ndate: 2021-04-18 18:24:14\ncategories: 學習日記 -->\n<p>關於共用表單頁面、表單驗證的 ui 的一些想法...</p>\n<!-- more -->\n<h2 id=\"共用元件\">共用元件<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#共用元件\"></a></h2>\n<p>通常新增和編輯的頁面會需要共用</p>\n<h3 id=\"法-1-蒐集資料用的表單包含打-api-功能\">法 1: 蒐集資料用的表單(包含打 api 功能)<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#法-1-蒐集資料用的表單包含打-api-功能\"></a></h3>\n<h5 id=\"-新增時\">📌 新增時<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#-新增時\"></a></h5>\n<ol>\n<li>要給 api 用的資料會要在共用元件裡蒐集起來，打 api</li>\n</ol>\n<h5 id=\"-編輯時\">📌 編輯時<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#-編輯時\"></a></h5>\n<ol>\n<li>要先在編輯頁打 api 拿到資料 input 到共用元件</li>\n<li>給 api 用的資料會要在共用元件裡蒐集起來，打 api\n(編輯比新增多一步驟)</li>\n</ol>\n<p>新增頁面和編輯頁面的送出按鈕都會寫在共用元件裡，\n這樣需要多 input 一個參數來看現在是在編輯狀態還是新增狀態，\n然後打 api 會跟著按鈕走，所以打新增和修改的 api 的動作會寫在共用元件裡...</p>\n<p>所以共用元件除了欄位驗證邏輯會寫裡面，還要 input 狀態進去判斷現在是要新增還編輯，還要根據狀態打不同的 api\n那這樣拆成新增編輯 component 就只是為了 routing 比較方便了</p>\n<h3 id=\"法-2-reactiveform-同步雙向綁定\">法 2: ReactiveForm 同步雙向綁定<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#法-2-reactiveform-同步雙向綁定\"></a></h3>\n<p>如果我是用 ReactiveForm 做共用元件的話就可以把按鈕放到各自新增和編輯的 component、也可以各自注入 service 打 api\n這樣共用元件的功能就單純很多: 欄位驗證、蒐集資料、角色判斷、控制欄位 disable\n不用幫畫面的按鈕做狀態判斷是否顯示\n然後打 API 前的資料的檢查(轉成字串、是否要吃使用者輸入的資料還是寫死)就是在各自的 component 裡判斷、注入 api 的 service\n<strong>相對法 1 ，法 2 可以讓共用元件更專注在驗證邏輯和資料的邏輯(就不用去在意 input 和新增編輯狀態的管理)</strong>\n所以我從頭到尾只用在意輸入的資料，完全不用去管什麼時候要 input output、 input output 的值變化後什麼時候被什麼事件觸發去改變值\n我只要輸入資料，資料就在共用元件裡經過驗證，並根據傳入的資料做介面的變化\n其他打 api 的動作也拆出去在共用元件以外的地方做，讓共用元件真的就只用做 ui 與資料驗證的控制就好</p>\n<p>所以我是比較喜歡用 ReactiveForm 來做共用元件 xD</p>\n<h4 id=\"法-2-demo\">法 2 demo<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#法-2-demo\"></a></h4>\n<p><a href=\"https://stackblitz.com/edit/angular-ivy-qaqscf?file=src/app/app.component.ts\">⚡stackblitz ReactiveForm 共用元件</a></p>\n<blockquote>\n<p>此 demo 參考自 <a href=\"https://coryrylan.com/blog/building-reusable-forms-in-angular\">Building Reusable Forms in Angular - Cory Rylan</a></p>\n</blockquote>\n<h4 id=\"參考資料\">參考資料<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#參考資料\"></a></h4>\n<p><a href=\"https://ithelp.ithome.com.tw/articles/10195280\">[功能介紹-10] Reactive Forms (Model-Driven Forms)</a></p>\n<hr>\n<h2 id=\"欄位驗證\">欄位驗證<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#欄位驗證\"></a></h2>\n<p><a href=\"https://indepth.dev/posts/1224/angular-forms-useful-tips\">Angular Forms: Useful Tips - Armen Vardanyan</a></p>\n<blockquote>\n<p>Forms are not type-safe</p>\n</blockquote>\n<ul>\n<li>可以使用 Pipes 做 ui 顯示轉換的處理</li>\n<li>可以使用 Directives 做表單的驗證處理</li>\n</ul>\n<h3 id=\"欄位驗證的方式\">欄位驗證的方式<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#欄位驗證的方式\"></a></h3>\n<ul>\n<li>\n<p>只能輸入...: 只能輸入中英、只能輸入英文、只能輸入數字、只能輸入特定幾個字\n=> 直接讓使用者不能敲除了規定以外的字就不用做錯誤提示了!(使用者在輸入時將不符合規定的都置換成空字串'')</p>\n</li>\n<li>\n<p>限制字數\n=> 使用 html <code>&#x3C;input type=\"text\"></code> 的 <code>maxlength</code> 去限制字數\n不要用 <code>type=\"number\"</code> 不然沒辦法精準控制輸入的字數...</p>\n</li>\n<li>\n<p>錯誤提示: 達到特定條件要提示錯誤，如. 必須大於 0、起訖日有誤\n=> 用 (input) 和 (change) 去綁事件判斷不符合條件時 formControl 要 setErrors() 並加入 html 提示\n可以將事件方法和錯誤 dom 抽出來寫成 directive</p>\n</li>\n</ul>\n<h4 id=\"錯誤題示-directive-demo\">錯誤題示 directive demo<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#錯誤題示-directive-demo\"></a></h4>\n<p><a href=\"https://stackblitz.com/edit/angular-ivy-bsunxe?file=src/app/app.component.html\">⚡stackblitz 將錯誤題示寫成 directive</a></p>\n<hr>\n<h2 id=\"tags\">Tags<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tags\"></a></h2>\n<ol>\n<li><a class=\"color-tag\" style=\"--tag-color: #017371;\" href=\"/notes/zavPiB0ApTq1sGZOGq9xJ\">PROG.Angular</a></li>\n</ol>","noteIndex":{"id":"root","title":"( Φ w Φ )","desc":"","updated":1650381339323,"created":1595961348801,"stub":false,"custom":{"stub":false,"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"7760ffb80fec59f813a8350ce254bcb0","links":[],"anchors":{},"children":["Cybv0wy1d2NbWoMaJ9Xst","jJJHMSzIVnRXuspVex7z3","u4tSbmkJewrKonY3sL544","WAKWMq3SeVmlAmZRqCbpB","rEbR1FrKkZzyjo6ahAgm3"],"parent":null,"data":{},"body":"\nDendron 官網: https://wiki.dendron.so/\n\n<!-- ![[首次使用 Dendron 紀錄|drops.2021.1226-first-day#使用-dendron-紀錄:#*]] -->\n<!-- <div class=\"portal-container\">\n<div class=\"portal-head\">\n<div class=\"portal-backlink\">\n<div class=\"portal-title\">From <span class=\"portal-text-title\">1226 使用 Dendron 紀錄</span></div>\n<a href=\"/notes/DTeYpEuPv3KIHugUyqZPu\" class=\"portal-arrow\">Go to text <span class=\"right-arrow\">→</span></a>\n</div>\n</div>\n<div id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\">\n<div class=\"portal-parent-fader-top\"></div>\n<div class=\"portal-parent-fader-bottom\"></div><h2 id=\"使用-dendron-紀錄\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#使用-dendron-紀錄\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>使用 Dendron 紀錄</h2>\n</div></div> -->\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"dendronVersion":"0.92.1"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"/ᐠ ._. ᐟ\\✧","description":"網頁開發技術筆記"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"master","editViewMode":"tree","editRepository":"https://github.com/kiwijang/kiwijang.github.io.git"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"siteUrl":"https://kiwijang.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"},"site":{"siteHierarchies":["root"],"siteRootDir":"docs","siteUrl":"https://kiwijang.github.io","title":"/ᐠ ._. ᐟ\\✧"}}},"__N_SSG":true}